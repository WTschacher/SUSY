<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Surrogate Synchrony — susy • SUSY</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Surrogate Synchrony — susy"><meta property="og:description" content="Cross-correlations are computed up to a specific lag in seconds Maxlag, then aggregated within a chosen Segment of e.g. 30s. Aggregation is performed by transforming correlations to Fisher's Z, then computing mean Z in each segment, then across all segments of the time series. Segment shuffling is used to create surrogate time series, on which the same computations are run. This provides effect sizes ES. SUSY provides two different synchrony measures of each twin time series: mean Z and ES of mean Z; mean absolute_Z and ES of mean absolute_Z.
  Legacy implementation is available at old.susy."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SUSY</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/WTschacher/SUSY/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Surrogate Synchrony</h1>
    
    <div class="hidden name"><code>susy.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Cross-correlations are computed up to a specific lag in seconds <code>Maxlag</code>, then aggregated within a chosen <code>Segment</code> of e.g. 30s. Aggregation is performed by transforming correlations to Fisher's Z, then computing mean Z in each segment, then across all segments of the time series. Segment shuffling is used to create surrogate time series, on which the same computations are run. This provides effect sizes <code>ES</code>. SUSY provides two different synchrony measures of each twin time series: <code>mean Z</code> and <code>ES of mean Z</code>; <code>mean absolute_Z</code> and <code>ES of mean absolute_Z</code>.<br>
  Legacy implementation is available at <code><a href="old.susy.html">old.susy</a></code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">susy</span><span class="op">(</span><span class="va">x</span>, permutation<span class="op">=</span><span class="cn">FALSE</span>, epoch<span class="op">=</span><span class="fl">30L</span>, fps<span class="op">=</span><span class="fl">15L</span>, maxlag<span class="op">=</span><span class="fl">3L</span><span class="op">*</span><span class="va">fps</span>,</span>
<span>  pseudo.simplify<span class="op">=</span><span class="cn">FALSE</span>, pseudo.total<span class="op">=</span><span class="fl">500L</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>A data.frame of numeric columns.</p></dd>

  <dt>permutation</dt>
<dd><p>Logical, default <code>FALSE</code> requires <code>x</code> to have even number of columns which are processed in pairs (1-2, 3-4, etc.). When <code>permutation</code> is <code>TRUE</code> then function computes all pairs combinations between columns provided in <code>x</code> (<code>n*(n-1)/2</code> pairs).</p></dd>

  <dt>epoch</dt>
<dd><p>Integer, segment size in seconds, default <code>30L</code>. Must not be smaller than time window (<code>fps</code>), also <code>epoch*fps</code> must not be greater than the timepoints (<code>nrow(x)/2</code>). Example 1: timepoints: 1000, fps = 10, so the epoch must not be greater than 50s (<code>=1000/(10*2)</code>); Example 2: maxlag : 90, fps = 10, so epoch must not be less than 9s (<code>=90/10</code>).</p></dd>

  <dt>fps</dt>
<dd><p>Integer, frames per second (sampling rate), default <code>15L</code>.</p></dd>

  <dt>maxlag</dt>
<dd><p>Integer, window size for <code><a href="https://rdrr.io/r/stats/acf.html" class="external-link">ccf</a></code>, maximum lag in seconds, default <code>3L*fps</code>.</p></dd>

  <dt>pseudo.simplify</dt>
<dd><p>Logical, default <code>FALSE</code>. Simplify calculation of the pseudo data.</p></dd>

  <dt>pseudo.total</dt>
<dd><p>Integer, default <code>500L</code>. Ignored when <code>pseudo.simplify</code> is <code>FALSE</code> (default).</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Segments are non-overlapping, and the number of segments that fit into the time series may have a remainder (usually a few seconds at the end of the time series), which is not considered.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    

<p>Object of class <code>susy</code> is returned. Each cross correlation pair is an element in resulting object.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="plot.susy.html">plot.susy</a></code>, <code><a href="print.susy.html">print.susy</a></code>, <code><a href="old.susy.html">old.susy</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  var1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>,<span class="fl">300</span>,<span class="fl">330</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  var2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>,<span class="fl">300</span>,<span class="fl">330</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  var3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>,<span class="fl">300</span>,<span class="fl">330</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## use only first two columns</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">=</span> <span class="fu">susy</span><span class="op">(</span><span class="va">data</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "var1-var2"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## use all columns and permutation</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">=</span> <span class="fu">susy</span><span class="op">(</span><span class="va">data</span>, permutation<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "var1-var2" "var1-var3" "var2-var3"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## print susy</span></span></span>
<span class="r-in"><span><span class="va">res</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Var1 Var2 n(data)          Z   Z-Pseudo      SD(Z) SD(Z-Pseudo) n(lags)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 var1 var2    1000 0.03452312 0.03955354 0.01820813   0.01861211      91</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 var1 var3    1000 0.03821652 0.03242691 0.02162886   0.01785053      91</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 var2 var3    1000 0.03553745 0.03700488 0.01852510   0.01989256      91</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   %&gt;Pseudo n(Segmente)          ES   Z(lead1)   Z(lead2)    ES(lead1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 36.26374           2 -0.27027679 0.03243375 0.03591506 -0.497470969</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 60.43956           2  0.32433838 0.03581875 0.04031753 -0.002108751</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 46.15385           2 -0.07376774 0.03607059 0.03522796 -0.032134130</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ES(lead2) meanZ(in-phase) meanZ(anti-phase) Anzahl(in-phase)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 -0.1381360      0.02439309       -0.02329122               47</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  0.6946167      0.02912177       -0.02980047               51</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -0.1046060      0.02701247       -0.02279094               41</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Anzahl(anti-phase)      Z(noAbs) Z(Pseudo-noAbs) %&gt;Pseudo(noAbs)   ES(noAbs)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                 44  0.0013369394   -0.0002166195        45.05495  0.04482044</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                 40  0.0032218848    0.0024051151        43.95604  0.03109527</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                 50 -0.0003520419    0.0031662224        47.25275 -0.10953553</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res</span>, legacy<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Var1 Var2 n(data) Z Z-Pseudo SD(Z) SD(Z-Pseudo) n(lags) %&gt;Pseudo n(Segmente) ES Z(lead1) Z(lead2) ES(lead1) ES(lead2) meanZ(in-phase) meanZ(anti-phase) Anzahl(in-phase) Anzahl(anti-phase) Z(noAbs) Z(Pseudo-noAbs) %&gt;Pseudo(noAbs) ES(noAbs) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> var1 var2 1000 0.03452312 0.03955354 0.01820813 0.01861211 91 36.26374 2 -0.2702768 0.03243375 0.03591506 -0.497471 -0.138136 0.02439309 -0.02329122 47 44 0.001336939 -0.0002166195 45.05495 0.04482044 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> var1 var3 1000 0.03821652 0.03242691 0.02162886 0.01785053 91 60.43956 2 0.3243384 0.03581875 0.04031753 -0.002108751 0.6946167 0.02912177 -0.02980047 51 40 0.003221885 0.002405115 43.95604 0.03109527 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> var2 var3 1000 0.03553745 0.03700488 0.0185251 0.01989256 91 46.15385 2 -0.07376774 0.03607059 0.03522796 -0.03213413 -0.104606 0.02701247 -0.02279094 41 50 -0.0003520419 0.003166222 47.25275 -0.1095355 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## plot susy</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, type<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Wolfgang Tschacher.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

